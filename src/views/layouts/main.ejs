<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= layout.title %></title>
    <meta
      name="description"
      content="A set of dumb IT tools for developers (basically just me and my friend), created by Nguyệt Ánh and Phúc An."
    />
    <meta name="og:title" content="<%= layout.title %>" />
    <meta
      name="og:image"
      content="https://it-tools.frilly.dev/static/images/icon.png"
    />
    <meta name="og:url" content="https://it-tools.frilly.dev" />
    <meta
      name="og:description"
      content="A set of dumb IT tools for developers (basically just me and my friend), created by Nguyệt Ánh and Phúc An."
    />

    <link rel="stylesheet" href="/static/css/tailwind.css" />
    <link rel="icon" href="/icon.png" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Funnel+Display:wght@300..800&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap"
      rel="stylesheet"
    />

    <!-- CDNJS for JQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- CDNJS for GSAP -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.7/dist/gsap.min.js"></script>

    <!-- CDNJS for FLIP -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.7/dist/Flip.min.js"></script>

    <script>
      if (localStorage.getItem("theme") == "dark") {
        $("html").addClass("dark");
      } else {
        localStorage.setItem("theme", "light");
      }

      document.addEventListener("DOMContentLoaded", () => {
        gsap.registerPlugin(Flip);
      });
    </script>
  </head>

  <style>
    body {
      grid-template-rows: 64px 1fr;
    }

    .toolbar-opened > aside {
      translate: 0%;
      position: absolute;
      inset: 0px;
      z-index: 50;
      size: 100% 100%;
    }

    .toolbar-closed > aside {
      translate: -100%;
      position: absolute;
      inset: 0px;
      z-index: 50;
      size: 100% 100%;
    }

    aside {
      scrollbar-width: none;
    }

    @media screen and (min-width: 1024px) {
      body {
        grid-template-columns: 300px 1fr;
      }

      .toolbar-opened > aside {
        grid-column-start: 1;
        grid-row-start: 2;
        position: relative;
      }

      .toolbar-opened > main {
        grid-column-start: 2;
        grid-row-start: 2;
      }

      .toolbar-closed > aside {
        display: none;
      }

      .toolbar-closed > main {
        grid-column-start: 1;
        grid-column-end: 3;
        grid-row-start: 2;
      }
    }

    body {
      background-image: url("/static/images/bg-light.png");
      background-position: center;
      background-size: cover;
    }

    .dark body {
      background-image: url("/static/images/bg-dark.png");
    }
  </style>

  <body
    class="font-poppins dark:text-pearl toolbar-closed grid min-h-screen w-full justify-stretch bg-white text-zinc-950 duration-200 lg:max-h-screen lg:gap-6 lg:p-6 dark:bg-zinc-900/75"
  >
    <nav
      class="relative flex items-center justify-between gap-8 bg-zinc-200/75 px-6 py-1 backdrop-blur-md lg:col-span-2 lg:rounded-xl dark:bg-zinc-800/75"
    >
      <button
        id="toolbar-toggle"
        class="dark:hover:fill-pearl/50 dark:fill-pearl cursor-pointer fill-zinc-950 duration-200 hover:fill-zinc-950/50"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 -960 960 960"
          class="size-6"
        >
          <path
            d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"
          />
        </svg>
      </button>

      <a
        id="nav-title"
        href="/"
        class="dark:from-cotton-candy from-cadillac to-bashful dark:to-cadillac top-1/2 left-1/2 hidden -translate-x-1/2 -translate-y-1/2 cursor-pointer bg-gradient-to-r bg-clip-text text-2xl font-black text-transparent duration-200 hover:scale-110 lg:absolute lg:block"
      >
        IT Tools
      </a>

      <div class="flex flex-row items-center gap-4">
        <button
          onclick="toggleDarkMode()"
          aria-label="Toggle dark mode"
          class="cursor-pointer"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 -960 960 960"
            class="fill-pearl hover:fill-pearl/50 hidden size-6 dark:block"
          >
            <path
              d="M480-360q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0 80q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Zm326-268Z"
            />
          </svg>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 -960 960 960"
            class="block size-6 fill-zinc-950 hover:fill-zinc-950/50 dark:hidden"
          >
            <path
              d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Zm-10-270Z"
            />
          </svg>
        </button>

        <% if (content.session) { %>
        <div class="flex flex-row items-center gap-4">
          <p>
            Hello, @<span class="underline"
              ><%= content.session.username %></span
            >
          </p>

          <a
            href="/logout"
            class="rounded-lg border-2 border-rose-600 bg-rose-600 px-4 py-2 font-semibold text-white duration-200 hover:bg-transparent hover:text-black dark:border-rose-300 dark:bg-rose-300 dark:text-black dark:hover:text-white"
            >Logout</a
          >
        </div>
        <% } else { %>
        <a
          href="/login"
          class="dark:border-cotton-candy border-bashful bg-bashful hover:text-bashful dark:bg-cotton-candy dark:hover:text-cotton-candy text-pearl rounded-full border-2 px-6 py-2 font-semibold duration-200 hover:bg-transparent dark:text-black"
          >Login</a
        >
        <% } %>
      </div>
    </nav>

    <aside
      id="toolbar"
      class="flex max-h-full flex-col gap-8 overflow-y-scroll bg-zinc-200 p-6 py-16 duration-200 lg:rounded-xl lg:bg-zinc-200/75 lg:py-6 lg:backdrop-blur-md dark:bg-zinc-800 dark:lg:bg-zinc-800/75"
    >
      <button
        id="toolbar-close"
        class="hover:fill-pearl/50 absolute top-6 right-6 lg:hidden"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 -960 960 960"
          class="fill-pearl size-6"
        >
          <path
            d="M480-424 284-228q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536-480l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-424Z"
          />
        </svg>
      </button>

      <% content.tools.forEach(section => { %>
      <div class="flex flex-col gap-4">
        <h2 class="text-sm font-semibold text-zinc-400 uppercase">
          <%= section.name %>
        </h2>

        <div class="flex flex-col items-start gap-1">
          <% section.tools.forEach(tool => { %>
          <div
            class="hover:text-bashful dark:hover:text-pearl/50 flex flex-row items-center gap-2 duration-200"
          >
            <img
              src="/static/images/tools/light/<%= tool.path %>.svg"
              alt=""
              class="size-4 dark:hidden"
            />
            <img
              src="/static/images/tools/dark/<%= tool.path %>.svg"
              alt=""
              class="hidden size-4 dark:block"
            />

            <% if(tool.state == "disabled") { %>
            <span class="cursor-pointer line-through"><%= tool.name %></span>
            <% } else if (content.selectedTool && content.selectedTool ==
            tool.id) { %>
            <a
              href="/<%= tool.path %>"
              class="dark:from-pearl from-cadillac to-bashful dark:to-cotton-candy bg-gradient-to-r bg-clip-text font-semibold text-transparent underline"
              ><%= tool.name %></a
            >
            <% } else { %>
            <a href="/<%= tool.path %>"><%= tool.name %></a>
            <% } %> <% if (tool.premium) { %>
            <span
              class="from-cadillac group to-bashful dark:from-lavender dark:to-cotton-candy relative cursor-pointer bg-gradient-to-r bg-clip-text font-bold text-transparent"
              >P

              <span
                class="absolute top-0 left-1/2 hidden w-fit -translate-x-1/2 -translate-y-full rounded-lg bg-white px-2 py-1 text-xs text-black shadow-sm group-hover:block"
                >Premium</span
              >
            </span>
            <% } %> <% if (tool.state == "disabled") { %>
            <svg
              class="h-[16px] w-[16px] text-rose-600 dark:text-rose-300"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
              viewBox="0 0 24 24"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-width="2"
                d="m6 6 12 12m3-6a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
              />
            </svg>

            <% } %>
          </div>
          <% }) %>
        </div>
      </div>
      <% }) %>
    </aside>

    <main
      id="main-content"
      class="flex size-full flex-col items-center gap-4 overflow-y-scroll bg-zinc-200/75 p-6 backdrop-blur-md lg:rounded-xl dark:bg-zinc-800/75"
    >
      <%- include('../pages/' + layout.content) %>
    </main>
  </body>

  <script defer>
    function toggleDarkMode() {
      $("html").toggleClass("dark");
      localStorage.setItem(
        "theme",
        $("html").hasClass("dark") ? "dark" : "light",
      );
    }

    function closeToolbar() {
      $("body").removeClass("toolbar-opened").addClass("toolbar-closed");
    }

    function openToolbar() {
      $("body").removeClass("toolbar-closed").addClass("toolbar-opened");
    }

    $("#toolbar-close").on("click", closeToolbar);

    $("#toolbar-toggle").on("click", () => {
      if ($("body").hasClass("toolbar-opened")) {
        closeToolbar();
      } else {
        openToolbar();
      }
    });
  </script>
</html>
